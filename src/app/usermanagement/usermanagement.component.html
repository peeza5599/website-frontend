<!-- ‚úÖ Navbar ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏≥‡∏ó‡∏≤‡∏á -->
<nav class="navbar">
  <button class="nav-btn" routerLink="/usermanagement">User Management</button>
  <button class="nav-btn" routerLink="/adduser">Add User</button>
  <button class="nav-btn active" routerLink="/history">History</button>
  <button class="logout-btn" routerLink="/login">üö™ Logout</button>
</nav>

<div *ngIf="isLoading" class="loading">Loading...</div>

<div *ngIf="!isLoading && users.length > 0" class="card-container">
  <div *ngFor="let user of users" class="card">
    <div class="card-image-container">
      <img *ngIf="user.image_url" [src]="user.image_url" alt="{{ user.name }}" class="card-image" />
    </div>
    <div class="card-content">
      <h2>{{ user.name }}</h2>
      <p><strong>ID:</strong> {{ user.id }}</p>
      <p><strong>Role:</strong> {{ user.role }}</p>
      <p><strong>Major:</strong> {{ user.standing }}</p>
      <p><strong>Class:</strong> {{ user.studyclass }}</p>
      <p><strong>Attendance:</strong> {{ user.total_attendance }}</p>
      <p><strong>Last Attendance:</strong> {{ user.last_attendance_time }}</p>
    </div>

    <div class="button-container">
      <button class="edit-button" (click)="editUser(user)">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
      <button class="delete-button" (click)="deleteUser(user.id)">üóëÔ∏è ‡∏•‡∏ö</button>
    </div>
  </div>
</div>

<div *ngIf="isEditing" class="edit-form">
  <h2>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>

  <!-- ‚úÖ ‡∏ä‡∏∑‡πà‡∏≠ -->
  <label for="name">‡∏ä‡∏∑‡πà‡∏≠:</label>
  <input id="name" [(ngModel)]="formData.name" name="name" required       pattern="^[A-Za-z ]+$"
  (keypress)="validateEnglishInput($event)" />

  <!-- ‚úÖ Role -->
  <label for="role">Role:</label>
  <select id="role" [(ngModel)]="formData.role" name="role" (change)="updateFormFields()" required>
    <option value="student">Student</option>
    <option value="teacher">Teacher</option>
    <option value="visitor">Visitor</option>
  </select>

  <!-- ‚úÖ Major -->
  <label for="standing">Major:</label>
  <input type="text" id="standing" [(ngModel)]="formData.standing" name="standing" [readonly]="formData.role !== 'visitor'" required />

  <!-- ‚úÖ Class -->
  <label for="studyClass">Class:</label>
  <select id="studyClass" [(ngModel)]="formData.studyClass" name="studyClass" [disabled]="formData.role === 'visitor'" required>
    <option *ngIf="formData.role === 'student' || formData.role === 'teacher'" value="Database">Database</option>
    <option *ngIf="formData.role === 'student' || formData.role === 'teacher'" value="Network">Network</option>
    <option *ngIf="formData.role === 'visitor'" value="-">-</option>
  </select>

  <!-- ‚úÖ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ -->
  <label for="profileImage">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå (PNG ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô):</label>
  <input type="file" id="profileImage" (change)="onFileSelected($event)" accept="image/png" />

  <div class="button-container">
    <button class="save-button" (click)="updateUser()">‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
    <button class="cancel-button" (click)="cancelEdit()">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
  </div>
</div>

<div *ngIf="!isLoading && users.length === 0">
  <p>No users found.</p>
</div>
